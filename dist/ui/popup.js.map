{
  "version": 3,
  "sources": ["../../src/ui/popup.ts"],
  "sourcesContent": ["import type { ContentResponse, SearchResult } from \"../shared/types\";\r\n\r\nconst queryInput = document.querySelector<HTMLInputElement>(\"#query\");\r\nconst searchButton = document.querySelector<HTMLButtonElement>(\"#search\");\r\nconst statusEl = document.querySelector<HTMLDivElement>(\"#status\");\r\nconst resultsEl = document.querySelector<HTMLUListElement>(\"#results\");\r\nconst emptyEl = document.querySelector<HTMLDivElement>(\"#empty\");\r\n\r\nif (!queryInput || !searchButton || !statusEl || !resultsEl || !emptyEl) {\r\n  throw new Error(\"Popup elements missing.\");\r\n}\r\n\r\nconst formatTime = (seconds: number) => {\r\n  const total = Math.floor(seconds);\r\n  const mins = Math.floor(total / 60);\r\n  const secs = total % 60;\r\n  return `${mins}:${secs.toString().padStart(2, \"0\")}`;\r\n};\r\n\r\nconst setStatus = (message: string) => {\r\n  statusEl.textContent = message;\r\n};\r\n\r\nconst clearResults = () => {\r\n  resultsEl.innerHTML = \"\";\r\n};\r\n\r\nconst renderResults = (results: SearchResult[]) => {\r\n  clearResults();\r\n\r\n  if (results.length === 0) {\r\n    emptyEl.hidden = false;\r\n    return;\r\n  }\r\n\r\n  emptyEl.hidden = true;\r\n\r\n  for (const item of results) {\r\n    const li = document.createElement(\"li\");\r\n    const time = document.createElement(\"span\");\r\n    time.className = \"time\";\r\n    time.textContent = formatTime(item.start);\r\n\r\n    const text = document.createElement(\"span\");\r\n    text.className = \"text\";\r\n    text.textContent = item.text;\r\n\r\n    const jump = document.createElement(\"button\");\r\n    jump.textContent = \"Jump\";\r\n    jump.addEventListener(\"click\", () => sendSeek(item.start));\r\n\r\n    li.append(time, text, jump);\r\n    resultsEl.appendChild(li);\r\n  }\r\n};\r\n\r\nconst sendToActiveTab = <T,>(message: unknown): Promise<T> =>\r\n  new Promise((resolve, reject) => {\r\n    chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n      const tab = tabs[0];\r\n      if (!tab?.id) {\r\n        reject(new Error(\"No active YouTube tab found.\"));\r\n        return;\r\n      }\r\n\r\n      chrome.tabs.sendMessage(tab.id, message, (response) => {\r\n        const error = chrome.runtime.lastError;\r\n        if (error) {\r\n          reject(new Error(error.message));\r\n          return;\r\n        }\r\n        resolve(response as T);\r\n      });\r\n    });\r\n  });\r\n\r\nconst sendSearch = async (query: string) => {\r\n  setStatus(\"Searching transcript...\");\r\n  searchButton.disabled = true;\r\n\r\n  try {\r\n    const response = await sendToActiveTab<ContentResponse>({ type: \"search\", query });\r\n    if (response.type === \"error\") {\r\n      setStatus(response.message);\r\n      renderResults([]);\r\n      return;\r\n    }\r\n    setStatus(response.info);\r\n    renderResults(response.results);\r\n  } catch (error) {\r\n    const message = error instanceof Error ? error.message : \"Search failed.\";\r\n    setStatus(message);\r\n    renderResults([]);\r\n  } finally {\r\n    searchButton.disabled = false;\r\n  }\r\n};\r\n\r\nconst sendSeek = async (time: number) => {\r\n  try {\r\n    await sendToActiveTab({ type: \"seek\", time });\r\n  } catch (error) {\r\n    const message = error instanceof Error ? error.message : \"Unable to jump.\";\r\n    setStatus(message);\r\n  }\r\n};\r\n\r\nsearchButton.addEventListener(\"click\", () => {\r\n  const query = queryInput.value.trim();\r\n  if (!query) {\r\n    setStatus(\"Type a prompt to search.\");\r\n    return;\r\n  }\r\n  sendSearch(query);\r\n});\r\n\r\nqueryInput.addEventListener(\"keydown\", (event) => {\r\n  if (event.key === \"Enter\") {\r\n    searchButton.click();\r\n  }\r\n});\r\n"],
  "mappings": "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",
  "names": []
}
